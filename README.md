# ShipTrackerRT ‚Äî Real-Time Maritime Vessel Tracker

–ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∏ –æ—Ç–∫—Ä—ã—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–æ—Ä—Å–∫–∏—Ö —Å—É–¥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—É–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö AIS (Automatic Identification System).

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É —á–µ—Ä–µ–∑ WebSocket –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞** ‚Äî Leaflet –∫–∞—Ä—Ç–∞ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∫–æ—Ä–∞–±–ª–µ–π –∏ popup-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ JSON (orjson), –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω—É** ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ bounding boxes –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
- **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** ‚Äî PostgreSQL –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π –∏ –∏—Å—Ç–æ—Ä–∏–∏
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î** ‚Äî pgAdmin –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã** ‚Äî Apache Superset –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞
- **–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî Docker Compose –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend:**
  - Python 3.11 (asyncio, websockets)
  - FastAPI + WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  - orjson –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON (+20-50% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
  - asyncpg –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
  - loguru –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **Database:**
  - PostgreSQL 15
  - pgAdmin 4 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î

- **Frontend:**
  - HTML5 + JavaScript
  - Leaflet –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç
  - WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

- **Analytics:**
  - Apache Superset –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤

- **Infrastructure:**
  - Docker & Docker Compose
  - –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- AIS API –∫–ª—é—á –æ—Ç [aisstream.io](https://aisstream.io) (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <repository-url>
cd ship-tracer-rt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env-example`:

```bash
cp .env-example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ:
- `SECRET_KEY_SHIPAPI` ‚Äî –≤–∞—à API –∫–ª—é—á –æ—Ç aisstream.io
- `POSTGRES_PASSWORD` ‚Äî –ø–∞—Ä–æ–ª—å –¥–ª—è PostgreSQL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `PG_ADMIN_WEB_EMAIL` –∏ `PG_ADMIN_WEB_PASSWORD` ‚Äî —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è pgAdmin (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

```bash
docker-compose up -d
```

### 4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (30-60 —Å–µ–∫—É–Ω–¥)

Superset –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker logs ship-tracer-superset-init -f
```

### 5. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **Real-time –∫–∞—Ä—Ç–∞:** http://localhost:8000
- **pgAdmin (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î):** http://localhost:5050
- **Superset (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞):** http://localhost:8088
  - Username: `admin`
  - Password: `admin`

## üì° –ü–æ—Ä—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| API (FastAPI) | 8000 | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å real-time –∫–∞—Ä—Ç–æ–π |
| PostgreSQL | 5433 | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø) |
| pgAdmin | 5050 | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î |
| Superset | 8088 | –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ—Ä—Ç 5433 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ PostgreSQL (—á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º PostgreSQL –Ω–∞ 5432). –í–Ω—É—Ç—Ä–∏ Docker-—Å–µ—Ç–∏ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ—Ä—Ç 5432.

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–≥–∏–æ–Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config.py`:

```python
AIS_BOUNDING_BOXES = [[[min_lat, min_lon], [max_lat, max_lon]]]
```

–ü—Ä–∏–º–µ—Ä –¥–ª—è –°–∏–Ω–≥–∞–ø—É—Ä–∞ –∏ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–µ–π:
```python
AIS_BOUNDING_BOXES = [[[-11, 178], [30, 74]]]
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–í `.env` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

```bash
AIS_LOG_STATS_INTERVAL=5      # –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
AIS_LOG_DETAILED=false        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ship-tracer-rt/
‚îú‚îÄ‚îÄ app/                    # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ api_server.py      # FastAPI —Å–µ—Ä–≤–µ—Ä —Å WebSocket
‚îÇ   ‚îú‚îÄ‚îÄ database.py        # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ map_utils.py       # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫–∞—Ä—Ç
‚îú‚îÄ‚îÄ collector/             # –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö AIS
‚îÇ   ‚îú‚îÄ‚îÄ ais_client.py      # –ö–ª–∏–µ–Ω—Ç AIS –ø–æ—Ç–æ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ ship_repository.py # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ db_pool.py         # –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ init_postgres/         # SQL —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ init_postgres.sql  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ migrate_*.sql     # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test/                  # –¢–µ—Å—Ç—ã –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ jupyter.ipynb     # Jupyter notebook
‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docker-compose.yaml   # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ requirements.txt      # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ collector

```bash
docker logs ship-tracer-collector -f
```

–î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```
15:30:36 | 12 msg/s | Total: 105 | Known ships: 13
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API

```bash
docker logs ship-tracer-api -f
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

1. –û—Ç–∫—Ä–æ–π—Ç–µ pgAdmin: http://localhost:5050
2. –í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ `.env`
3. –î–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä–≤–µ—Ä:
   - Host: `postgres`
   - Port: `5432`
   - Database: `shiptracer`
   - Username: `postgres`
   - Password: –∏–∑ `.env`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `ship_positions_current`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Superset –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `scripts/setup_superset_db.py`.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**

1. **–í–ê–ñ–ù–û:** –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ Superset —Å –¥—Ä–∞–π–≤–µ—Ä–æ–º PostgreSQL:
   ```bash
   docker-compose build superset
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã:
   ```bash
   docker-compose up -d
   ```

3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Superset (–æ–∫–æ–ª–æ 30-60 —Å–µ–∫—É–Ω–¥):
   ```bash
   docker logs ship-tracer-superset-init -f
   ```

4. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
   ```
   ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ
   ```

**–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–µ—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞):**

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤—Ä—É—á–Ω—É—é**

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Superset –∑–∞–ø—É—â–µ–Ω
docker-compose up -d superset

# –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30-60 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
docker-compose run --rm superset-init python3.11 /app/scripts/setup_superset_db.py
```

–ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –∏ requests):
```bash
export SUPERSET_URL=http://localhost:8088
export SUPERSET_USERNAME=admin
export SUPERSET_PASSWORD=admin
export POSTGRES_HOST=postgres
export POSTGRES_PORT=5432
export POSTGRES_USER=postgres
export POSTGRES_PASSWORD=postgres
export POSTGRES_DB=shiptracer

python3 scripts/setup_superset_db.py
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

1. –û—Ç–∫—Ä–æ–π—Ç–µ Superset: http://localhost:8088
2. –í–æ–π–¥–∏—Ç–µ:
   - Username: `admin`
   - Password: `admin`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Database Connections** ‚Üí **+ Database**
4. **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **"Connect a database"** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ **"PostgreSQL"**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Display Name:** `Ship Tracker PostgreSQL`
   - **SQLAlchemy URI:** `postgresql://postgres:postgres@postgres:5432/shiptracer`
     (–∑–∞–º–µ–Ω–∏—Ç–µ `postgres:postgres` –Ω–∞ `–≤–∞—à_username:–≤–∞—à_–ø–∞—Ä–æ–ª—å` –∏–∑ `.env`, –µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)
   - **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `postgres:5432` (–∏–º—è —Å–µ—Ä–≤–∏—Å–∞ Docker), –∞ –ù–ï `localhost:5433`!
   - –ù–∞–∂–º–∏—Ç–µ **Test Connection** ‚Üí –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, –Ω–∞–∂–º–∏—Ç–µ **Connect**

**–ï—Å–ª–∏ —Ñ–æ—Ä–º–∞ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (Host, Port) –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ç–æ–ª—å–∫–æ SQLAlchemy URI** –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `postgresql://username:password@host:port/database`
- –î–ª—è Docker –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ `postgres` –≤–º–µ—Å—Ç–æ `localhost`
- –ü–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏: `5432` (–Ω–µ `5433`!)

**–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞:**

1. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Lab** ‚Üí **SQL Editor**
2. –í—ã–±–µ—Ä–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `Ship Tracker PostgreSQL`
3. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
   ```sql
   SELECT 
       ship_id,
       latitude,
       longitude,
       speed_over_ground,
       course_over_ground,
       heading,
       timestamp,
       updated_at
   FROM ship_positions_current
   ORDER BY updated_at DESC
   LIMIT 100;
   ```
4. –ù–∞–∂–º–∏—Ç–µ **Run** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
5. –ù–∞–∂–º–∏—Ç–µ **Explore** ‚Üí **Save** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
6. –°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
   - **Table** ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∞–±–ª–µ–π
   - **Map** ‚Äî –∫–∞—Ä—Ç–∞ —Å –ø–æ–∑–∏—Ü–∏—è–º–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
   - **Chart** ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏, –∫—É—Ä—Å–∞ –∏ —Ç.–¥.

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤:**

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–∞–±–ª–µ–π:
  ```sql
  SELECT COUNT(*) as active_ships
  FROM ship_positions_current
  WHERE updated_at > NOW() - INTERVAL '1 hour';
  ```

- –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ –∫–æ—Ä–∞–±–ª—è–º:
  ```sql
  SELECT 
      ship_id,
      AVG(speed_over_ground) as avg_speed,
      MAX(speed_over_ground) as max_speed
  FROM ship_positions_current
  WHERE speed_over_ground IS NOT NULL
  GROUP BY ship_id
  ORDER BY avg_speed DESC;
  ```

- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∑–∏—Ü–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å:
  ```sql
  SELECT 
      ship_id,
      latitude,
      longitude,
      timestamp
  FROM ship_positions_history
  WHERE timestamp > NOW() - INTERVAL '1 hour'
  ORDER BY timestamp DESC;
  ```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ collector —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   docker ps | grep collector
   docker logs ship-tracer-collector
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ –ë–î —á–µ—Ä–µ–∑ pgAdmin

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API:
   ```bash
   docker logs ship-tracer-api
   ```

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω: `docker ps | grep postgres`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`
- –í–Ω—É—Ç—Ä–∏ Docker –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `postgres:5432`, —Å–Ω–∞—Ä—É–∂–∏ `localhost:5433`

### WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

- –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 8000 –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### Superset –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î

**–û—à–∏–±–∫–∞ "Could not load database driver: PostgresEngineSpec":**

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥—Ä–∞–π–≤–µ—Ä PostgreSQL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –æ–±—Ä–∞–∑–µ Superset. –†–µ—à–µ–Ω–∏–µ:

1. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ Superset:
   ```bash
   docker-compose build superset
   docker-compose up -d superset
   ```

2. –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (30-60 —Å–µ–∫—É–Ω–¥) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å–Ω–æ–≤–∞

**–î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
   ```bash
   docker logs ship-tracer-superset-init
   ```

2. –ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é (—Å–º. —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Superset –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤")

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SQLAlchemy URI:
   ```
   postgresql://postgres:postgres@postgres:5432/shiptracer
   ```
   (–∑–∞–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –Ω–∞ –≤–∞—à –∏–∑ `.env`)

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω:
   ```bash
   docker ps | grep postgres
   docker logs ship-tracer-postgres
   ```

5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env` –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ü–∞—Ä—Å–∏–Ω–≥ JSON:** orjson –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç +20-50% —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º json
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (loguru) –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–ë–î:** –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ asyncpg –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
